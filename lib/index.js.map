{"version":3,"sources":["../index.js"],"names":[],"mappings":";;;;;;;QAQgB;QA0CA;;;;;;;;;;;;;;;;;;;;;;AA5ChB,IAAM,QAAQ,oBAAK,6EAAL,CAAR;;AAEC,SAAS,cAAT,CAAwB,SAAxB,EAAmC,QAAnC,EAA6C;AAClD,MAAI,QAAQ,IAAR,CAD8C;;AAGlD,MAAI,aAAa,UAAU,UAAV,CAAqB,MAArB,GAA8B,CAA9B,EAAiC;AAChD,cAAU,SAAV,GAAsB,EAAtB,CADgD;GAAlD;;AAIA,MAAM,SAAS,SAAT,MAAS,CAAC,MAAD,EAAY;AACzB,QAAM,WAAW,kBAAQ,sBAAa,QAArB,CAAX,CADmB;AAEzB,UAAM,KAAN,EAAa,QAAb,EAFyB;AAGzB,YAAQ,QAAR,CAHyB;GAAZ,CAPmC;;AAalD,MAAM,SAAS,SAAT,MAAS,CAAC,MAAD,EAAS,OAAT,EAAqB;AAClC,YAAQ,kBAAQ,sBAAa,QAArB,CAAR,CADkC;AAElC,UAAM,SAAN,EAAiB,KAAjB,EAFkC;GAArB,CAbmC;;AAkBlD,SAAO,SAAS,QAAT,CAAkB,WAAlB,EAA+B,OAA/B,EAAwC;AAC7C,WAAO,UAAU,IAAV,GACH,OAAO,WAAP,EAAoB,OAApB,CADG,GAEH,OAAO,WAAP,EAAoB,OAApB,CAFG,CADsC;GAAxC,CAlB2C;CAA7C;;AAyBP,SAAS,OAAT,CAAiB,SAAjB,EAA4B;AAC1B,SAAO,MAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,SAA3B,EAAsC,CAAtC,CAAP,CAD0B;CAA5B;;AAIA,IAAM,aAAa,EAAb;;AAEN,OAAO,MAAP,GAAgB,YAAM;AACpB,SAAO,IAAP,CAAY,SAAZ,EACG,OADH,CACW,qBAAa;AACpB,QAAM,SAAS,WAAW,SAAX,CAAT,CADc;AAEpB,WAAO,OAAP,CAAe,iBAAS;AACtB,eAAS,IAAT,CAAc,mBAAd,CAAkC,MAAM,IAAN,EAAY,MAAM,QAAN,CAA9C,CADsB;KAAT,CAAf,CAFoB;GAAb,CADX,CADoB;AAQpB,cAAY,IAAZ,CARoB;CAAN;;AAWT,SAAS,MAAT,CAAgB,QAAhB,EAA0B,IAA1B,EAAgC,OAAhC,EAAyC;AAC9C,MAAM,eAAe,WAAW,IAAX,MAAqB,WAAW,IAAX,IAAmB,EAAnB,CAArB,CADyB;AAE9C,MAAM,WAAW,QAAQ,SAAS,gBAAT,CAA0B,QAA1B,CAAR,CAAX,CAFwC;AAG9C,MAAM,WAAW,SAAX,QAAW,CAAC,CAAD,EAAO;AACtB,QAAM,gBAAgB,SAAS,MAAT,CAAgB;aAAW,YAAY,EAAE,MAAF;KAAvB,CAAhC,CADgB;AAEtB,kBAAc,OAAd,CAAsB;aAAW,QAAQ,CAAR;KAAX,CAAtB,CAFsB;GAAP,CAH6B;AAO9C,MAAM,QAAQ;AACZ,sBADY;AAEZ,sBAFY;AAGZ,sBAHY;AAIZ,cAJY;AAKZ,oBALY;GAAR,CAPwC;AAc9C,MAAI,aAAa,MAAb,CAAoB;WAAK,EAAE,IAAF,KAAW,IAAX,IACxB,EAAE,OAAF,KAAc,OAAd,IACA,EAAE,QAAF,KAAe,QAAf;GAFmB,CAApB,CAE0B,MAF1B,KAEqC,CAFrC,EAEwC;;AAE1C,aAAS,IAAT,CAAc,gBAAd,CAA+B,IAA/B,EAAqC,QAArC,EAF0C;AAG1C,iBAAa,IAAb,CAAkB,KAAlB,EAH0C;GAF5C;CAdK","file":"index.js","sourcesContent":["import { init } from \"snabbdom\";\r\nimport classModule from \"snabbdom/modules/class\";\r\nimport propsModule from \"snabbdom/modules/props\";\r\nimport styleModule from \"snabbdom/modules/style\";\r\nimport eventModule from \"snabbdom/modules/eventlisteners\";\r\n\r\nconst patch = init([classModule, propsModule, styleModule, eventModule]);\r\n\r\nexport function createRenderer(container, dispatch) {\r\n  let vNode = null;\r\n\r\n  if (container && container.childNodes.length > 0) {\r\n    container.innerHTML = \"\";\r\n  }\r\n\r\n  const update = (render) => {\r\n    const newVNode = render({dispatch, ...context});\r\n    patch(vNode, newVNode);\r\n    vNode = newVNode;\r\n  };\r\n\r\n  const create = (render, context) => {\r\n    vNode = render({dispatch, ...context});\r\n    patch(container, vNode);\r\n  };\r\n\r\n  return function renderer(renderVNode, context) {\r\n    return vNode !== null\r\n      ? update(renderVNode, context)\r\n      : create(renderVNode, context);\r\n  };\r\n}\r\n\r\nfunction toArray(arrayLike) {\r\n  return Array.prototype.slice.call(arrayLike, 0);\r\n}\r\n\r\nconst eventCache = {};\r\n\r\nwindow.unload = () => {\r\n  Object.keys(listeners)\r\n    .forEach(eventName => {\r\n      const events = eventCache[eventName];\r\n      events.forEach(event => {\r\n        document.body.removeEventListener(event.name, event.listener);\r\n      });\r\n    });\r\n  listeners = null;\r\n};\r\n\r\nexport function events(selector, name, handler) {\r\n  const eventsByName = eventCache[name] || (eventCache[name] = []);\r\n  const elements = toArray(document.querySelectorAll(selector));\r\n  const listener = (e) => {\r\n    const validElements = elements.filter(element => element === e.target);\r\n    validElements.forEach(element => handler(e));\r\n  };\r\n  const event = {\r\n    listener,\r\n    selector,\r\n    elements,\r\n    name,\r\n    handler\r\n  };\r\n  if (eventsByName.filter(e => e.name === name\r\n    && e.handler === handler\r\n    && e.selector === selector).length === 0) {\r\n\r\n    document.body.addEventListener(name, listener);\r\n    eventsByName.push(event);\r\n  }\r\n}"]}